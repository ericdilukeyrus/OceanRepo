{
	"name": "df_copy_all_mbr",
	"properties": {
		"folder": {
			"name": "01ODS"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_raw_mbr_pnl_data",
						"type": "DatasetReference"
					},
					"name": "getMBRData",
					"description": "Retrieve Actual CY,LY & Budget"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_ocean_stg_nonecrypted",
						"type": "DatasetReference"
					},
					"name": "insertRawMBRData"
				}
			],
			"transformations": [
				{
					"name": "addMBRMetadata",
					"description": "BU_Code\nBU_Name\nMBR_Scope\nMBR_Month"
				},
				{
					"name": "removeEmptyColumns"
				}
			],
			"scriptLines": [
				"parameters{",
				"     pBU_Code as string,",
				"     pRawTableName as string,",
				"     pMBR_Scope as string,",
				"     pMBR_Month as string,",
				"     pBU_Name as string,",
				"     pCurrency_Code as string,",
				"     pFileName as string",
				"}",
				"source(output(",
				"          {_col0_} as string,",
				"          {_col1_} as string,",
				"          {_col2_} as string,",
				"          {_col3_} as string,",
				"          {_col4_} as string,",
				"          {_col5_} as string,",
				"          {_col6_} as string,",
				"          {_col7_} as string,",
				"          {_col8_} as string,",
				"          {_col9_} as string,",
				"          {_col10_} as string,",
				"          {_col11_} as string,",
				"          {_col12_} as string,",
				"          {_col13_} as string,",
				"          {_col14_} as string,",
				"          {_col15_} as string,",
				"          {_col16_} as string,",
				"          {_col17_} as string,",
				"          {_col18_} as string,",
				"          {_col19_} as string,",
				"          {_col20_} as string,",
				"          {_col21_} as string,",
				"          {_col22_} as string,",
				"          {_col23_} as string,",
				"          {_col24_} as string,",
				"          {_col25_} as string,",
				"          {_col26_} as string,",
				"          {_col27_} as string,",
				"          {_col28_} as string,",
				"          {_col29_} as string,",
				"          {_col30_} as string,",
				"          {_col31_} as string,",
				"          {_col32_} as string,",
				"          {_col33_} as string,",
				"          {_col34_} as string,",
				"          {_col35_} as string,",
				"          {_col36_} as string,",
				"          {_col37_} as string,",
				"          {_col38_} as string,",
				"          {_col39_} as string,",
				"          {_col40_} as string,",
				"          {_col41_} as string,",
				"          {_col42_} as string,",
				"          {_col43_} as string,",
				"          {_col44_} as string",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> getMBRData",
				"getMBRData derive(BU_Code = $pBU_Code,",
				"          BU_Name = $pBU_Name,",
				"          Currency_Code = $pCurrency_Code,",
				"          MBR_Scope = $pMBR_Scope,",
				"          MBR_Month = $pMBR_Month,",
				"          CostCenter_Code = left({_col1_},7)) ~> addMBRMetadata",
				"addMBRMetadata select(mapColumn(",
				"          {_col0_},",
				"          {_col1_},",
				"          {_col2_},",
				"          {_col4_},",
				"          {_col5_},",
				"          {_col6_},",
				"          {_col7_},",
				"          {_col8_},",
				"          {_col9_},",
				"          {_col10_},",
				"          {_col11_},",
				"          {_col12_},",
				"          {_col13_},",
				"          {_col14_},",
				"          {_col15_},",
				"          {_col16_},",
				"          {_col19_},",
				"          {_col20_},",
				"          {_col21_},",
				"          {_col22_},",
				"          {_col23_},",
				"          {_col24_},",
				"          {_col25_},",
				"          {_col26_},",
				"          {_col27_},",
				"          {_col28_},",
				"          {_col29_},",
				"          {_col30_},",
				"          {_col33_},",
				"          {_col34_},",
				"          {_col35_},",
				"          {_col36_},",
				"          {_col37_},",
				"          {_col38_},",
				"          {_col39_},",
				"          {_col40_},",
				"          {_col41_},",
				"          {_col42_},",
				"          {_col43_},",
				"          {_col44_},",
				"          BU_Code,",
				"          BU_Name,",
				"          Currency_Code,",
				"          MBR_Scope,",
				"          MBR_Month,",
				"          CostCenter_Code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> removeEmptyColumns",
				"removeEmptyColumns sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Index as string,",
				"          Anaplant_Index as string,",
				"          PBI_Index as string,",
				"          K_Nature as string,",
				"          Actual_LY_01 as string,",
				"          Actual_LY_02 as string,",
				"          Actual_LY_03 as string,",
				"          Actual_LY_04 as string,",
				"          Actual_LY_05 as string,",
				"          Actual_LY_06 as string,",
				"          Actual_LY_07 as string,",
				"          Actual_LY_08 as string,",
				"          Actual_LY_09 as string,",
				"          Actual_LY_10 as string,",
				"          Actual_LY_11 as string,",
				"          Actual_LY_12 as string,",
				"          Budget_CY_01 as string,",
				"          Budget_CY_02 as string,",
				"          Budget_CY_03 as string,",
				"          Budget_CY_04 as string,",
				"          Budget_CY_05 as string,",
				"          Budget_CY_06 as string,",
				"          Budget_CY_07 as string,",
				"          Budget_CY_08 as string,",
				"          Budget_CY_09 as string,",
				"          Budget_CY_10 as string,",
				"          Budget_CY_11 as string,",
				"          Budget_CY_12 as string,",
				"          Actual_CY_01 as string,",
				"          Actual_CY_02 as string,",
				"          Actual_CY_03 as string,",
				"          Actual_CY_04 as string,",
				"          Actual_CY_05 as string,",
				"          Actual_CY_06 as string,",
				"          Actual_CY_07 as string,",
				"          Actual_CY_08 as string,",
				"          Actual_CY_09 as string,",
				"          Actual_CY_10 as string,",
				"          Actual_CY_11 as string,",
				"          Actual_CY_12 as string,",
				"          BU_Code as string,",
				"          BU_Name as string,",
				"          Currency_Code as string,",
				"          MBR_Scope as string,",
				"          MBR_Month as string,",
				"          CostCenter_Code as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     recreate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          BU_Code,",
				"          BU_Name,",
				"          Currency_Code,",
				"          MBR_Scope,",
				"          MBR_Month",
				"     )) ~> insertRawMBRData"
			]
		}
	}
}