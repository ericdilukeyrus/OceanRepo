{
	"name": "df_copy_all_mbr_snowflake",
	"properties": {
		"folder": {
			"name": "01ODS"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_raw_mbr_pnl_data",
						"type": "DatasetReference"
					},
					"name": "getMBRData",
					"description": "Retrieve Actual CY,LY & Budget"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_snowf_raw_mbr_pnl_data",
						"type": "DatasetReference"
					},
					"name": "insertRawMBRDataSnowf"
				}
			],
			"transformations": [
				{
					"name": "addMBRMetadata",
					"description": "BU_Code\nBU_Name\nMBR_Scope\nMBR_Month"
				},
				{
					"name": "removeEmptyColumns"
				}
			],
			"scriptLines": [
				"parameters{",
				"     pBU_Code as string,",
				"     pRawTableName as string,",
				"     pMBR_Scope as string,",
				"     pMBR_Month as string,",
				"     pBU_Name as string,",
				"     pCurrency_Code as string,",
				"     pFileName as string",
				"}",
				"source(output(",
				"          {_col0_} as short,",
				"          {_col1_} as string,",
				"          {_col2_} as string,",
				"          {_col3_} as string,",
				"          {_col4_} as string,",
				"          {_col5_} as double,",
				"          {_col6_} as double,",
				"          {_col7_} as double,",
				"          {_col8_} as double,",
				"          {_col9_} as double,",
				"          {_col10_} as double,",
				"          {_col11_} as double,",
				"          {_col12_} as double,",
				"          {_col13_} as double,",
				"          {_col14_} as double,",
				"          {_col15_} as double,",
				"          {_col16_} as double,",
				"          {_col17_} as double,",
				"          {_col18_} as string,",
				"          {_col19_} as double,",
				"          {_col20_} as double,",
				"          {_col21_} as double,",
				"          {_col22_} as double,",
				"          {_col23_} as double,",
				"          {_col24_} as double,",
				"          {_col25_} as double,",
				"          {_col26_} as double,",
				"          {_col27_} as double,",
				"          {_col28_} as double,",
				"          {_col29_} as double,",
				"          {_col30_} as double,",
				"          {_col31_} as double,",
				"          {_col32_} as string,",
				"          {_col33_} as double,",
				"          {_col34_} as double,",
				"          {_col35_} as double,",
				"          {_col36_} as double,",
				"          {_col37_} as double,",
				"          {_col38_} as double,",
				"          {_col39_} as double,",
				"          {_col40_} as double,",
				"          {_col41_} as double,",
				"          {_col42_} as double,",
				"          {_col43_} as double,",
				"          {_col44_} as double,",
				"          {_col45_} as double,",
				"          {_col46_} as double,",
				"          {_col47_} as double,",
				"          {_col48_} as double",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> getMBRData",
				"getMBRData derive(BU_Code = $pBU_Code,",
				"          BU_Name = $pBU_Name,",
				"          Currency_Code = $pCurrency_Code,",
				"          MBR_Scope = $pMBR_Scope,",
				"          MBR_Month = $pMBR_Month,",
				"          CostCenter_Code = left({_col1_},7)) ~> addMBRMetadata",
				"addMBRMetadata select(mapColumn(",
				"          {_col0_},",
				"          {_col1_},",
				"          {_col2_},",
				"          {_col4_},",
				"          {_col5_},",
				"          {_col6_},",
				"          {_col7_},",
				"          {_col8_},",
				"          {_col9_},",
				"          {_col10_},",
				"          {_col11_},",
				"          {_col12_},",
				"          {_col13_},",
				"          {_col14_},",
				"          {_col15_},",
				"          {_col16_},",
				"          {_col19_},",
				"          {_col20_},",
				"          {_col21_},",
				"          {_col22_},",
				"          {_col23_},",
				"          {_col24_},",
				"          {_col25_},",
				"          {_col26_},",
				"          {_col27_},",
				"          {_col28_},",
				"          {_col29_},",
				"          {_col30_},",
				"          {_col33_},",
				"          {_col34_},",
				"          {_col35_},",
				"          {_col36_},",
				"          {_col37_},",
				"          {_col38_},",
				"          {_col39_},",
				"          {_col40_},",
				"          {_col41_},",
				"          {_col42_},",
				"          {_col43_},",
				"          {_col44_},",
				"          {_col46_},",
				"          {_col47_},",
				"          {_col48_},",
				"          BU_Code,",
				"          BU_Name,",
				"          Currency_Code,",
				"          MBR_Scope,",
				"          MBR_Month,",
				"          CostCenter_Code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> removeEmptyColumns",
				"removeEmptyColumns sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Index as decimal(38,0),",
				"          Anaplant_Index as string,",
				"          PBI_Index as string,",
				"          K_Nature as string,",
				"          Actual_LY_01 as double,",
				"          Actual_LY_02 as double,",
				"          Actual_LY_03 as double,",
				"          Actual_LY_04 as double,",
				"          Actual_LY_05 as double,",
				"          Actual_LY_06 as double,",
				"          Actual_LY_07 as double,",
				"          Actual_LY_08 as double,",
				"          Actual_LY_09 as double,",
				"          Actual_LY_10 as double,",
				"          Actual_LY_11 as double,",
				"          Actual_LY_12 as double,",
				"          Budget_CY_01 as double,",
				"          Budget_CY_02 as double,",
				"          Budget_CY_03 as double,",
				"          Budget_CY_04 as double,",
				"          Budget_CY_05 as double,",
				"          Budget_CY_06 as double,",
				"          Budget_CY_07 as double,",
				"          Budget_CY_08 as double,",
				"          Budget_CY_09 as double,",
				"          Budget_CY_10 as double,",
				"          Budget_CY_11 as double,",
				"          Budget_CY_12 as double,",
				"          Actual_CY_01 as double,",
				"          Actual_CY_02 as double,",
				"          Actual_CY_03 as double,",
				"          Actual_CY_04 as double,",
				"          Actual_CY_05 as double,",
				"          Actual_CY_06 as double,",
				"          Actual_CY_07 as double,",
				"          Actual_CY_08 as double,",
				"          Actual_CY_09 as double,",
				"          Actual_CY_10 as double,",
				"          Actual_CY_11 as double,",
				"          Actual_CY_12 as double,",
				"          Actual_NY_01 as double,",
				"          Actual_NY_02 as double,",
				"          Actual_NY_03 as double,",
				"          BU_Code as string,",
				"          BU_Name as string,",
				"          Currency_Code as string,",
				"          MBR_Scope as string,",
				"          MBR_Month as string,",
				"          CostCenter_Code as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     recreate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true,",
				"     mapColumn(",
				"          Index = {_col0_},",
				"          Anaplant_Index = {_col1_},",
				"          PBI_Index = {_col2_},",
				"          K_Nature = {_col4_},",
				"          Actual_LY_01 = {_col5_},",
				"          Actual_LY_02 = {_col6_},",
				"          Actual_LY_03 = {_col7_},",
				"          Actual_LY_04 = {_col8_},",
				"          Actual_LY_05 = {_col9_},",
				"          Actual_LY_06 = {_col10_},",
				"          Actual_LY_07 = {_col11_},",
				"          Actual_LY_08 = {_col12_},",
				"          Actual_LY_09 = {_col13_},",
				"          Actual_LY_10 = {_col14_},",
				"          Actual_LY_11 = {_col15_},",
				"          Actual_LY_12 = {_col16_},",
				"          Budget_CY_01 = {_col19_},",
				"          Budget_CY_02 = {_col20_},",
				"          Budget_CY_03 = {_col21_},",
				"          Budget_CY_04 = {_col22_},",
				"          Budget_CY_05 = {_col23_},",
				"          Budget_CY_06 = {_col24_},",
				"          Budget_CY_07 = {_col25_},",
				"          Budget_CY_08 = {_col26_},",
				"          Budget_CY_09 = {_col27_},",
				"          Budget_CY_10 = {_col28_},",
				"          Budget_CY_11 = {_col29_},",
				"          Budget_CY_12 = {_col30_},",
				"          Actual_CY_01 = {_col33_},",
				"          Actual_CY_02 = {_col34_},",
				"          Actual_CY_03 = {_col35_},",
				"          Actual_CY_04 = {_col36_},",
				"          Actual_CY_05 = {_col37_},",
				"          Actual_CY_06 = {_col38_},",
				"          Actual_CY_07 = {_col39_},",
				"          Actual_CY_08 = {_col40_},",
				"          Actual_CY_09 = {_col41_},",
				"          Actual_CY_10 = {_col42_},",
				"          Actual_CY_11 = {_col43_},",
				"          Actual_CY_12 = {_col44_},",
				"          Actual_NY_01 = {_col46_},",
				"          Actual_NY_02 = {_col47_},",
				"          Actual_NY_03 = {_col48_},",
				"          BU_Code,",
				"          BU_Name,",
				"          Currency_Code,",
				"          MBR_Scope,",
				"          MBR_Month,",
				"          CostCenter_Code",
				"     )) ~> insertRawMBRDataSnowf"
			]
		}
	}
}